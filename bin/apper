#!/usr/bin/env node

var argv = require('minimist')(process.argv.slice(2)),
    path = require('path');

if (argv.h || argv.help) {
    console.log([
        "usage: apper [path] [options]",
        "",
        "options:",
        "  -p --port          Port to use [8000]",
        "  -a --address       Address to use [0.0.0.0]",
        "  -h --help          Print this list and exit."
    ].join('\n'));
    process.exit();
}

var rootPath = argv._[0],
    port = argv.p || argv.port,
    host = argv.a || argv.address || '0.0.0.0';

if (rootPath) rootPath = path.resolve(rootPath);

// Start server
var app = require('../index')({ path: rootPath, toOpenBrowser: true });
app.start(port, host);

if (process.platform !== 'win32') {
    // Signal handlers don't work on Windows.
    process.on('SIGINT', function () {
        log('Apper server stopped.'.red);
        process.exit();
    });
}